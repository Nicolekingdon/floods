---
title: "Floods in the United States"
author: "Nicole Kingdon"
format: pdf
editor: visual
toc: true
bibliography: references.bib
---

# Introduction

Floods are extremely destructive storm events that are negatively impactful in any area of the world. Specifically, in the United States, post-flood recovery is offered through the Federal Emergency Management Agency (FEMA).

## Post-Flood Recovery Experiences

Experiences of post-flood recovery in the United States (US) vary by neighborhood [@varelavarela2023]. Additionally, these experiences differ for low-, middle-, or high-income populations [@varelavarela2023].

### Economically Marginalized Groups

Low-income populations already have previous material and relational hardships they experience daily ([@varelavarela2023; @mijs2021]). Traumatic events, like floods, can exacerbate their hardships. Children and adolescents living in low-income households may experience long-term developmental impacts due to floods.

### Low-Income Children and Adolescents

Low-income children and adolescents directly and indirectly experience several material and relational hardships due to their economic status. Traumatic events, like floods, can increase developmental impacts, such as educational attainment ([@ahmed2022])), depressive symptoms ([@felton2013]), and post-traumatic stress disorder ([@liu2007]). Each of these impacts can impede children from reaching their full potential across their development.

## Family Stress Model

### Risk Factors

Figure 1 shows the Family Stress Model Framework ([@masarik2017]), which conceptualizes how risks, like floods, can impact low-income children. The economic hardship, like floods, is placed upon the household, which increases economic pressure. This increases parental/caregiver psychological distress, which is likely to impact relationships and parenting. Ultimately, the child may be impacted by experiencing adjustment problems across their development.

![Family Stress Model Framework. (Masarik & Conger, 2017)](1-s2.0-S2352250X16300549-gr1.jpg){fig-align="center" width="290"}

### Protective Factors

When protective factors, such as supports from Federal Emergency Management Agency (FEMA), are implemented to reduce economic hardships, then the family and child can be protected from the full impact of the economic hardship.

## FEMA Assistance

FEMA's mission is "helping people before, during, and after disasters." ([FEMA-Strategic-Plan](https://www.fema.gov/sites/default/files/documents/fema_2022-2026-strategic-plan.pdf)) The specifically provide post-disaster relief, in order to reduce the hardships that tend to arise. Additionally, they look to promote resilience against disasters, such as floods ([FEMA-Resilience](https://www.fema.gov/about/action/disaster-resilience)). There are three types of assistance programs that FEMA offers: Individuals and Households (IHA), Public Assistance (PA), and Hazard Mitigation (HM) ([FEMA-Declarations](https://www.fema.gov/openfema-data-page/disaster-declarations-summaries-v2)).

### Individuals and Households Assistance Program

The IHA Program is additional support offered to uninsured and under-insured expenses and needs through financial and direct services for individuals and households who experienced a disaster-related event ([FEMA-IHA](https://www.fema.gov/assistance/individual/program)). They can cover the following expenses and needs: money for temporary housing, a temporary housing unit, repairs of replacement of owner-occupied homes, and hazard mitigation to repair or rebuild stronger, more durable homes. Additionally other areas of need can be covered: damage to essential household items, clothing, clean-up items, tools and specialized clothing needed for one's job, educational materials, accessibility items, an essential vehicle, disaster-related funeral and burial expenses, disaster-related child-care expenses, medical and dental expenses, and moving and storage expenses ([FEMA-IHA-Services](https://www.fema.gov/assistance/individual/housing)).

### Public Assistance Program

The PA program has four eligibility components: **applicant** must be a state, territory, tribe, local government, or a certain nonprofit organization; a **facility** is a building, public works system, equipment, or improved and maintained natural feature; **work** is an "emergency" or "permanent" required because of the disaster-related event; **costs** must be used for disaster-related work. Ultimately, the PA program offers grants to particular types of applicants to do particular disaster-related work for a particular period of time necessary to support post-disaster relief ([FEMA-PA](https://www.fema.gov/assistance/public/process)).

#### Emergency Work (Duration: 6 Months)

-   Categorey A: Debris removal

-   Category B: Emergency protective measures

#### Permanent Work (Duration: 18 Months)

-   Category C: Roads and bridges

-   Category D: Water control facilities

-   Category E: Public buildings and equipment

-   Category F: Public utilities

-   Category G: Parks, recreational, and other facilities

## Aim

It is important to delineate how different racial and economic groups were impacted by floods, specifically among different counties in the US. This will have implications on different additional community resources that should be offered to those are racially and economically marginalized and experience hardships prior to disasters, such as floods.

# Data Acquisition & Assessment

There are three data sets used for this exploratory data analysis: one on Census data for all the counties in the US from 2023, and the other two on storm event data from the National Centers for Environmental Information (NOAA), one from 2020 and the other from 2021.

```{r}
#| echo: false
#| message: false
#| warning: false

library(readr)

census_2020 <- read_csv("Census Download_2023-10-23T135225/ACSST5Y2020.S1701-Data.csv")

census_2021 <- read_csv("Census Download_2023-10-23T135225/ACSST5Y2021.S1701-Data.csv")

fema_disaster_dec <- read_csv("DisasterDeclarationsSummaries.csv")

fema_web_disaster <- read_csv("FemaWebDisasterSummaries.csv")
```

```{r}
#| echo: false
#| message: false
#| warning: false

colnames(census_2020) <- census_2020[1, ]
census_2020 <- census_2020[-1, ]

colnames(census_2021) <- census_2021[1, ]
census_2021 <- census_2021[-1, ]
```

```{r}
#| echo: false
#| message: false
#| warning: false

library(dplyr)

census_2020 <- census_2020 |>
  mutate(year = "2020")

census_2021 <- census_2021 %>%
  mutate(new_column = "2021")

common_columns <- intersect(colnames(census_2020), colnames(census_2021))

census_2020 <- census_2020 |>
  select(all_of(common_columns))

census_2021 <- census_2021 |>
  select(all_of(common_columns))

census_2023<- rbind(census_2020, census_2021)

census_2023 <- census_2023 |> 
  mutate_all(~ifelse(. == "null", NA, .))

census_2023 <- census_2023 |> 
  select_if(~!all(is.na(.)))
```

```{r}
#| echo: false
#| message: false
#| warning: false

library(stringr)

census_2023 <- census_2023 |>
  rename_all(~str_replace_all(., "!!", "_")) |>
  rename_all(~str_replace_all(., " ", "_"))
```

```{r}
#| echo: false
#| message: false
#| warning: false

storm_20_21 <- merge(fema_disaster_dec, fema_web_disaster, by = "disasterNumber")

storm_20_21 <- storm_20_21 |>
  filter(incidentType == "Flood")
```

```{r}
#| echo: false
#| message: false
#| warning: false

library(tidyr)

storm_20_21 <- storm_20_21 |>
  separate_wider_delim(  cols = incidentBeginDate,
                         delim = "-",
                         names = c("incident_begin_year",
                                   "incident_begin_month",
                                   "incident_begin day"),
                         too_many = "error",
                         too_few = "align_start"
  )
```

```{r}
#| echo: false
#| message: false
#| warning: false

storm_20_21$incident_begin_year <- str_trim(storm_20_21$incident_begin_year, side = "both")

storm_20_21$incident_begin_year <- as.numeric(storm_20_21$incident_begin_year)

storm_20_21 <- storm_20_21 |>
  filter(incident_begin_year == "2020" | incident_begin_year == "2021")

```

```{r}
#| echo: false
#| message: false
#| warning: false

census_2023$Geographic_Area_Name <- sub("\\s\\w+$", "", census_2023$Geographic_Area_Name)

census_2023$Geographic_Area_Name <- sub("\\s\\w+,", "", census_2023$Geographic_Area_Name)

census_2023$Geographic_Area_Name <- sub(" and$", "", census_2023$Geographic_Area_Name)

census_2023$Geographic_Area_Name <- sub(" Census$", "", census_2023$Geographic_Area_Name)

storm_20_21$designatedArea <- sub(" \\(County\\)", "", storm_20_21$designatedArea)

storm_20_21$designatedArea <- sub(" \\(Parish\\)", "", storm_20_21$designatedArea)

storm_20_21 <- storm_20_21 |>
  rename(county = designatedArea)

census_2023 <- census_2023 |>
  rename(county = Geographic_Area_Name)
```

```{r}
#| echo: false
#| message: false
#| warning: false

storm_20_21 <- merge(storm_20_21, census_2023, by = "county")
```

```{r}
#| echo: false
#| message: false
#| warning: false

storm_20_21 <- storm_20_21 |>
  distinct(hash.x, .keep_all = TRUE)
```

```{r}
#| echo: false
#| message: false
#| warning: false

storm_20_21 <- storm_20_21 |>
  select(-id.x, -paLoadDate, -iaLoadDate, -hash.y, disasterCloseoutDate, -tribalRequest, -fipsStateCode, -fipsCountyCode, -placeCode, -declarationRequestNumber, -lastIAFilingDate, -lastRefresh.x, -lastRefresh.y, -id.y, -Geography)
```

```{r}
#| echo: false
#| message: false
#| warning: false

storm_20_21 <- storm_20_21 |>
  select(-matches("^Annotation"))

storm_20_21 <- storm_20_21 |>
  select(-disasterCloseoutDate)

storm_20_21 <- storm_20_21 |>
  select(-hash.x)

storm_20_21$totalNumberIaApproved <- as.numeric(storm_20_21$totalNumberIaApproved)

storm_20_21$Estimate_Total_Population_for_whom_poverty_status_is_determined <- as.numeric(storm_20_21$Estimate_Total_Population_for_whom_poverty_status_is_determined)
```

```{r}
#| echo: false
#| message: false
#| warning: false

storm_20_21 <- storm_20_21 |>
  mutate(incident_begin_years = incident_begin_year)

storm_20_21 <- storm_20_21 |>
  unite(incident_begin_date, incident_begin_year, incident_begin_month, 'incident_begin day', sep = "-")
```

```{r}
#| echo: false
#| message: false
#| warning: false

library(lubridate)

storm_20_21$incident_begin_date <- as.Date(storm_20_21$incident_begin_date)

storm_20_21$incidentEndDate <- as.Date(storm_20_21$incidentEndDate)

storm_20_21 <- storm_20_21 |>
  mutate(incident_length_days = as.numeric(difftime(incidentEndDate, incident_begin_date, units = "days")))
```

```{r}
#| echo: false
#| message: false
#| warning: false

storm_20_21$Estimate_Total_Population_for_whom_poverty_status_is_determined_AGE_Under_18_years_5_to_17_years <- as.numeric(storm_20_21$Estimate_Total_Population_for_whom_poverty_status_is_determined_AGE_Under_18_years_5_to_17_years)

storm_20_21$Estimate_Total_Population_for_whom_poverty_status_is_determined_AGE_Under_18_years_Under_5_years <- as.numeric(storm_20_21$Estimate_Total_Population_for_whom_poverty_status_is_determined_AGE_Under_18_years_Under_5_years)
```

```{r}
#| echo: false
#| message: false
#| warning: false

flood1 <- storm_20_21 |>
  filter(declarationTitle == "SEVERE, STORMS, FLOODING, LANDSLIDES, AND MUDSLIDES")

flood2 <- storm_20_21 |>
  filter(declarationTitle == "SEVERE STORMS, TORNADOES, AND FLOODING")

flood3 <- storm_20_21 |>
  filter(declarationTitle == "SEVERE STORM AND FLOODING")

flood4 <- storm_20_21 |>
  filter(declarationTitle == "FLOODING, LANDSLIDES, AND MUDSLIDES")

flood5 <- storm_20_21 |>
  filter(declarationTitle == "FLOODING")

flood6 <- storm_20_21 |>
  filter(declarationTitle == "SEVERE WINTER STORMS, SNOWSTORMS, STRAIGHT-LINE WINDS, FLOODIN")

flood7 <- storm_20_21 |>
  filter(declarationTitle == "SEVERE STORMS, FLOODING, LANDSLIDES, AND MUDSLIDES")

flood8 <- storm_20_21 |>
  filter(declarationTitle == "SEVERE WINTER STORM AND FLOODING")

flood9 <- storm_20_21 |>
  filter(declarationTitle == "SEVERE WINTER STORM AND FLOODING")

flood10 <- storm_20_21 |>
  filter(declarationTitle == "SEVERE STORMS, FLOODING, AND LANDSLIDES")

flood11 <- storm_20_21 |>
  filter(declarationTitle == "SEVERE STORMS, TORNADOES, AND FLOODING")

```

```{r}
#| echo: false
#| message: false
#| warning: false

library(ggplot2)

ggplot(data = storm_20_21,
       aes(x = incident_length_days, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined/10000), color = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~incident_begin_years, nrow = 1) +
  labs(
    title = "Figure 2. Length of Floods",
    subtitle = "Total Population in Poverty by County",
    x = "Length of Flood in Days",
    y = "Population living in Poverty (10000s)"
  ) +
  theme_classic() +
  theme(legend.position = "none")
```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
       aes(x = incident_length_days, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined/10000), color = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~incident_begin_years, nrow = 1) +
  labs(
    title = "Figure 2. Length of Floods",
    subtitle = "Total Population in Poverty by County",
    x = "Length of Flood in Days",
    y = "Population living in Poverty (10000s)"
  ) +
  theme_classic() +
  theme(legend.position = "none")
```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
       aes(x = incident_length_days, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined_AGE_Under_18_years_Under_5_years/10000), color = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~incident_begin_years, nrow = 1) +
  labs(
    title = "Figure 2. Length of Floods",
    subtitle = "Total Population in Poverty Under the Age of 5 by County",
    x = "Length of Flood in Days",
    y = "Population living in Poverty: Under 5 Years (10000s) (10000s)"
  ) +
  theme_classic() +
  theme(legend.position = "none")
```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
       mapping = aes(x = incident_begin_years, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined/10000), fill = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~ihProgramDeclared, nrow = 1) +
  labs(
    title = "Figure 2. Individuals and Household Program Declaration",
    subtitle = "Total Population in Poverty by County",
    x = "Year",
    y = "Population living in Poverty (10000s)"
  ) +
  theme_classic() +
  scale_x_continuous(breaks = c(2020, 2021)) + 
  theme(legend.position = "none")
```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
       aes(x = incident_begin_years, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined_AGE_Under_18_years_Under_5_years/10000), fill = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~ihProgramDeclared, nrow = 1) +
  labs(
    title = "Figure 2. Individuals and Household Program Declaration",
    subtitle = "Total Population in Poverty Under the Age of 5 by County",
    x = "Year",
    y = "Population living in Poverty: Under 5 Years (10000s)"
  ) +
  theme_classic() +
  scale_x_discrete() +
  scale_x_continuous(breaks = c(2020, 2021)) +
  theme(legend.position = "none")

```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
       aes(x = incident_begin_years, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined_AGE_Under_18_years_5_to_17_years/10000), fill = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~ihProgramDeclared, nrow = 1) +
  labs(
    title = "Figure 2. Individuals and Household Program Declaration",
    subtitle = "Total Population in Poverty from 5-to-17 Years of Age by County",
    x = "Year",
    y = "Population living in Poverty: 5-to-17 Years (10000s)"
  ) +
  theme_classic() +
  scale_x_discrete() +
  scale_x_continuous(breaks = c(2020, 2021)) +
  theme(legend.position = "none")
```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
                mapping = aes(x = incident_begin_years, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined/10000), fill = county)) +
                geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~iaProgramDeclared, nrow = 1) +
  labs(
    title = "Figure 2. Individuals Assistance Program Declaration",
                  subtitle = "Total Population in Poverty by County",
                  x = "Year",
                  y = "Population living in Poverty (10000s)"
                ) +
                theme_classic() +
                scale_x_continuous(breaks = c(2020, 2021)) + 
                theme(legend.position = "none")
```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
       aes(x = incident_begin_years, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined_AGE_Under_18_years_Under_5_years/10000), fill = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~iaProgramDeclared, nrow = 1) +
  labs(
    title = "Figure 2. Individuals Assistance Program Declaration",
    subtitle = "Total Population in Poverty Under the Age of 5 by County",
    x = "Year",
    y = "Population living in Poverty: Under 5 Years (10000s)"
  ) +
  theme_classic() +
  scale_x_discrete() +
  scale_x_continuous(breaks = c(2020, 2021)) +
  theme(legend.position = "none")

```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
       aes(x = incident_begin_years, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined_AGE_Under_18_years_5_to_17_years/10000), fill = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~iaProgramDeclared, nrow = 1) +
  labs(
    title = "Figure 2. Individuals Assistance Program Declaration",
    subtitle = "Total Population in Poverty from 5-to-17 Years of Age by County",
    x = "Year",
    y = "Population living in Poverty: 5-to-17 Years (10000s)"
  ) +
  theme_classic() +
  scale_x_discrete() +
  scale_x_continuous(breaks = c(2020, 2021)) +
  theme(legend.position = "none")
```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
       mapping = aes(x = incident_begin_years, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined/10000), fill = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~paProgramDeclared, nrow = 1) +
  labs(
    title = "Figure 2. Public Assistance Program Declaration",
    subtitle = "Total Population in Poverty by County",
    x = "Year",
    y = "Population living in Poverty (10000s)"
  ) +
  theme_classic() +
  scale_x_continuous(breaks = c(2020, 2021)) + 
  theme(legend.position = "none")
```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
       aes(x = incident_begin_years, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined_AGE_Under_18_years_Under_5_years/10000), fill = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~paProgramDeclared, nrow = 1) +
  labs(
    title = "Figure 2. Public Assistance Program Declaration",
    subtitle = "Total Population in Poverty Under the Age of 5 by County",
    x = "Year",
    y = "Population living in Poverty: Under 5 Years (10000s)"
  ) +
  theme_classic() +
  scale_x_discrete() +
  scale_x_continuous(breaks = c(2020, 2021)) +
  theme(legend.position = "none")
```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
       aes(x = incident_begin_years, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined_AGE_Under_18_years_5_to_17_years/10000), fill = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~paProgramDeclared, nrow = 1) +
  labs(
    title = "Figure 2. Public Assistance Program Declaration",
    subtitle = "Total Population in Poverty from 5-to-17 Years of Age by County",
    x = "Year",
    y = "Population living in Poverty: 5-to-17 Years (10000s)"
  ) +
  theme_classic() +
  scale_x_discrete() +
  scale_x_continuous(breaks = c(2020, 2021)) +
  theme(legend.position = "none")
```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
       mapping = aes(x = incident_begin_years, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined/10000), fill = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~hmProgramDeclared, nrow = 1) +
  labs(
    title = "Figure 2. Hazard Mitigation Program Declaration",
    subtitle = "Total Population in Poverty by County",
    x = "Year",
    y = "Population living in Poverty (10000s)"
  ) +
  theme_classic() +
  scale_x_continuous(breaks = c(2020, 2021)) +
  theme(legend.position = "none")
```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
       aes(x = incident_begin_years, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined_AGE_Under_18_years_Under_5_years/10000), fill = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~hmProgramDeclared, nrow = 1) +
  labs(
    title = "Figure 2. Hazard Mitigation Program Declaration",
    subtitle = "Total Population in Poverty Under the Age of 5 by County",
    x = "Year",
    y = "Population living in Poverty: Under 5 Years (10000s)"
  ) +
  theme_classic() +
  scale_x_discrete() +
  scale_x_continuous(breaks = c(2020, 2021)) +
  theme(legend.position = "none")
```

```{r}
#| echo: false
#| message: false
#| warning: false

ggplot(data = storm_20_21,
       aes(x = incident_begin_years, y = (Estimate_Total_Population_for_whom_poverty_status_is_determined_AGE_Under_18_years_5_to_17_years/10000), fill = county)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~hmProgramDeclared, nrow = 1) +
  labs(
    title = "Figure 2. Hazard Mitigation Program Declaration",
    subtitle = "Total Population in Poverty Under the Age of 5 by County",
    x = "Year",
    y = "Population living in Poverty: 5-to-17 Years (10000s)"
  ) +
  theme_classic() +
  scale_x_discrete() +
  scale_x_continuous(breaks = c(2020, 2021)) +
  theme(legend.position = "none")
```

# References
